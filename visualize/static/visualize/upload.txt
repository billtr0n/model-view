// add event listeners on page load
window.onload = function() {
    var fileInput = document.getElementById('file');
    var btnSubmit = document.getElementById('submit');
    btnSubmit.addEventListener('click', onSubmit)
    fileInput.addEventListener('change', displayUpload);
}

/*
* FUNCTIONS
*/
var displayUpload = function(e) {
    var file = e.target.files[0];
    var textType = /text.*/;
    if (file.type.match(textType)) { 
        var fr = new FileReader();
        fr.onload = function(e) {
            try {
                obj = JSON.parse(e.target.result);
            } catch(err) {
                alert('Invalid JSON.');
            }
            tableCreate();
        } 
        fr.readAsText(file);
    } else {
        console.log("Filetype not supported.");
    }
}

/* TODO: Add logic, to handle multiple file uploads before the submission */
function tableCreate(){
    var body = document.body;
    var tbl = document.createElement('table');
    for (i=0; i<obj.parameters.length; i++) {
        var tr = tbl.insertRow();
        for (key in obj.parameters[i]) {
            var td = tr.insertCell();
            td.appendChild(document.createTextNode(obj.parameters[i][key]));
        }
    }
    body.appendChild(tbl)
}

var onSubmit = function(e) {
        
}

// TODO: Implement method to prevent multiple tag submissions
function parseTags(e) {
    var txtTags = document.getElementById('tags');
    var tags = txtTags.value.split(',');
    if (tags === "") return
    for (i=0; i<tags.length; i++) {
        buf.tags[i] = tags[i].trim();
        console.log(buf.tags[i])
    }
}

function parseComments() {
}
